# Web3FuzzForge Exploit Templates

This directory contains test templates for Web3FuzzForge that identify common vulnerabilities in Web3 dApps, with focus on advanced attack vectors and edge cases.

## Test Cases

### 1. Uniswap Approval Overflow (uniswap-approval-overflow.fuzz.js)

Tests for vulnerabilities in token approval mechanisms including:

- Unlimited token approvals (`uint256.max`)
- Approval overflow detection
- Test-Mainnet chain mismatches in approvals
- Token approval resetting requirements

**Real-world impact:** Prevents users from giving excessive token permissions that can lead to asset loss.

### 2. Airdrop Batch Distribution Vulnerabilities (airdrop-batch-loss.test.ts)

Detects critical issues in airdrop systems including:

- Role assignment and privilege escalation
- Batch distribution array mismatches and integer overflows
- Unchecked token transfers and state validation
- Combined attack vectors using multiple vulnerabilities

**Real-world impact:** Many airdrops have lost significant funds due to these vulnerabilities.

### 3. Dark Forest ZK-SNARK Manipulation (darkforest-zk-replay.fuzz.ts)

Identifies vulnerabilities in ZK-based blockchain games including:

- ZK proof replay attacks
- Public signal manipulation
- Reentrancy in game actions
- ZK circuit implementation flaws (missing constraints)

**Real-world impact:** Prevents game state manipulation and resource theft in ZK applications.

### 4. Session Handling Vulnerabilities (session-handling.test.js)

Tests for common web security issues in dApp session management:

- Insecure session token storage (localStorage vs. cookies)
- Sensitive information leakage in error messages
- Cross-Site Request Forgery (CSRF) vulnerabilities
- Session fixation attack vectors

**Real-world impact:** Protects against account takeover, data leakage, and unauthorized transactions.

## Using These Templates

1. Install Web3FuzzForge: `npm install -g web3fuzzforge`
2. Run tests against your dApp: `web3fuzzforge run --template=examples/exploits/uniswap-approval-overflow.fuzz.js --url=YOUR_DAPP_URL`
3. Modify the test parameters as needed for your specific application

## Security Recommendations

These tests highlight common security issues in Web3 applications. Consider the following best practices:

- Always limit token approvals to exact amounts needed
- Implement proper role-based access control in contracts
- Enforce strong validation for all user inputs
- For ZK applications, implement replay protection
- Use the Checks-Effects-Interactions pattern to prevent reentrancy
- Store authentication tokens in secure, HttpOnly, SameSite cookies
- Implement proper CSRF protection for all state-changing operations
- Sanitize error messages to avoid leaking sensitive information

## Contributing

To add more tests or improve existing ones:

1. Follow the established patterns in these test files
2. Ensure thorough documentation of vulnerabilities
3. Include practical remediation steps
4. Test against known vulnerable contracts before submitting

## License

MIT License
